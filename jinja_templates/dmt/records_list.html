<div class="overflow-x-auto">
    <table class="min-w-full bg-white">
        <thead class="bg-gray-800 text-white">
            <tr>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">DMT #</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Part #</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Shop Order</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Status</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Workflow Stage</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Created At</th>
                <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Actions</th>
            </tr>
        </thead>
        <tbody class="text-gray-700">
            {% for record in records %}
            <tr class="border-b border-gray-200 hover:bg-gray-100 cursor-pointer {% if record.is_session %}bg-orange-50{% endif %}"
                hx-get="/dmt/edit/{{ record.id }}" hx-target="#main-content">
                <td class="py-3 px-4 font-medium">{{ record.report_number }}</td>
                <td class="py-3 px-4">{{ record.part_num }}</td>
                <td class="py-3 px-4">{{ record.shop_order }}</td>
                <td class="py-3 px-4">
                    <span class="px-3 py-1 rounded-full text-xs font-semibold
            {% if record.status == 'open' %}bg-green-200 text-green-800
            {% else %}bg-red-200 text-red-800{% endif %}">
                        {{ record.status.title() }}
                    </span>
                    {% if record.is_session %}
                    <span class="ml-2 px-3 py-1 rounded-full text-xs font-semibold bg-orange-200 text-orange-800">
                        Session
                    </span>
                    {% endif %}
                </td>
                <td class="py-3 px-4">
                    <span class="px-3 py-1 rounded-full text-xs font-semibold
            {% if record.workflow_status == 'draft' %}bg-gray-200 text-gray-700
            {% elif record.workflow_status == 'supervisor_review' %}bg-blue-200 text-blue-700
            {% elif record.workflow_status == 'manager_review' %}bg-yellow-200 text-yellow-700
            {% elif record.workflow_status == 'engineer_review' %}bg-purple-200 text-purple-700
            {% elif record.workflow_status == 'completed' %}bg-green-200 text-green-700
            {% endif %}">
                        {{ record.workflow_status.replace('_', ' ').title() }}
                    </span>
                </td>
                <td class="py-3 px-4">{{ record.created_at.split(' ')[0] if record.created_at else 'N/A' }}</td>

                
            </tr>
            {% else %}
            <tr>
                <td colspan="7" class="text-center py-8 text-gray-500">
                    No DMT records found.
                </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
</div>

<!-- Pagination -->
<div class="mt-6 flex justify-between items-center">
    <span class="text-sm text-gray-600">
        Showing {{ records|length }} of {{ total }} records.
    </span>
    <!-- You can add real pagination controls here later if you need them -->
</div>

<style>
    tr.htmx-swapping {
        opacity: 0;
        transition: opacity 0.4s ease-out;
    }
</style>
<script>
    document.body.addEventListener('htmx:afterSwap', (e) => {
        console.log("HTMX swapped:", e.target);
    });
    document.body.addEventListener('htmx:afterRequest', (e) => {
        console.log("HTMX request done:", e.detail.xhr.status);
    });
</script>